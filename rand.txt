# Define the directory to search and the person's name to filter by
$directoryPath = "C:\YourFolder"
$searchName = "NameOfPerson"

# Use Shell.Application COM object to access file metadata
$shell = New-Object -ComObject Shell.Application

# Check if the directory exists
if (Test-Path $directoryPath) {
    # Loop through each file in the directory
    Get-ChildItem -Path $directoryPath -Recurse -File | ForEach-Object {
        $filePath = $_.FullName
        $folder = $shell.Namespace((Get-Item $filePath).DirectoryName)
        $file = $folder.ParseName((Get-Item $filePath).Name)
        
        # Retrieve the "Last Saved By" property (index 10 in this case)
        $lastSavedBy = $folder.GetDetailsOf($file, 10)
        
        # Check if the property matches the specified person
        if ($lastSavedBy -eq $searchName) {
            Write-Output "File: $filePath"
            Write-Output "Last saved by: $lastSavedBy"
            Write-Output "------------------------"
        }
    }
} else {
    Write-Output "Directory not found at the specified path."
}
