def format_guv_sheet(writer, sheet_name):
    workbook = load_workbook(writer.path)
    worksheet = workbook[sheet_name]

    # Apply header formatting
    for cell in worksheet[1]:
        cell.font = Font(bold=True, color='FFFFFF')
        cell.fill = PatternFill(start_color='FF0000', end_color='FF0000', fill_type='solid')
        cell.alignment = Alignment(horizontal='center', vertical='center')

    # Rows to be bold
    bold_rows = [1, 3, 9, 14, 15, 21, 26, 30]

    for row in bold_rows:
        for cell in worksheet[row]:
            cell.font = Font(bold=True)

    # Adjust column widths to autofit
    for col in worksheet.columns:
        max_length = 0
        column = col[0].column_letter  # Get the column name
        for cell in col:
            try:
                if len(str(cell.value)) > max_length:
                    max_length = len(cell.value)
            except:
                pass
        adjusted_width = (max_length + 2)
        worksheet.column_dimensions[column].width = adjusted_width

    # Save the workbook
    workbook.save(writer.path)
