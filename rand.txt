# Define the directory to search, the person's name to filter by, and the output file path
$directoryPath = "C:\YourFolder"
$searchName = "NameOfPerson"
$outputFilePath = "C:\Path\To\Output.txt"

# Initialize output file
Out-File -FilePath $outputFilePath -Force -Encoding UTF8

# Use Shell.Application COM object to access file metadata
$shell = New-Object -ComObject Shell.Application

# Check if the directory exists
if (Test-Path $directoryPath) {
    # Loop through each file in the directory
    Get-ChildItem -Path $directoryPath -Recurse -File | ForEach-Object {
        $filePath = $_.FullName
        $folder = $shell.Namespace((Get-Item $filePath).DirectoryName)
        $file = $folder.ParseName((Get-Item $filePath).Name)
        
        # Retrieve the "Last Saved By" property (index 10 in this case)
        $lastSavedBy = $folder.GetDetailsOf($file, 10)
        
        # Check if the property matches the specified person
        if ($lastSavedBy -eq $searchName) {
            # Append output to the file
            Add-Content -Path $outputFilePath -Value "File: $filePath"
            Add-Content -Path $outputFilePath -Value "Last saved by: $lastSavedBy"
            Add-Content -Path $outputFilePath -Value "------------------------"
        }
    }
    
    Write-Output "Results written to $outputFilePath"
} else {
    Write-Output "Directory not found at the specified path."
}
